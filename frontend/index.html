<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <!-- Favicons pour barre des t√¢ches -->
  <link rel="stylesheet" href="./src/styles/style.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon_1.png">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‚öõÔ∏è Oracle d'Entropie Quantique-G√©om√©trique</title>
</head>

<body>
    <div class="app-container">
        <nav class="navigation">
            <button id="nav-main" class="nav-button active">G√©n√©rateur Al√©atoire Classique</button>
            <button id="nav-icosahedron" class="nav-button">Icosa√®dre Dynamique</button>
            <button id="nav-cubes" class="nav-button">Cubes Dynamiques</button>
            <button id="nav-spiral-simple" class="nav-button">Spiral Dynamique</button>
            <button id="nav-spiral-torus" class="nav-button">Spiral Toro√Ødale</button>
            <button id="nav-centrifuge-laser" class="nav-button">Centrifugeuse Laser</button>
            <button id="nav-centrifuge-laser-v2" class="nav-button">Centrifugeuse Laser 2.0</button>
            <button id="nav-torus-spring" class="nav-button">Tore-Ressorts</button>
            <button id="nav-crypto-token-river" class="nav-button">CryptoTokenRiver</button>
            <button id="nav-stream" class="nav-button">Flux de Tokens</button>
            <button id="nav-internal-tool" class="nav-button">Outil Interne de S√©curit√©</button>
            <button id="nav-metacube-oracle" class="nav-button">MetaCube Oracle</button>
            <button id="nav-admin-interface" class="nav-button">üéõÔ∏è Interface Admin</button>
        </nav>

        <!-- G√©n√©rateur Al√©atoire Classique -->
        <div id="main-interface" class="interface-section">
            <div class="content-card">
                <h1 class="title">Nombre Al√©atoire G√©n√©r√©</h1>
                <div class="input-group">
                    <label for="classic-token-length">Longueur du Token (8-128) :</label>
                    <input type="number" id="classic-token-length" value="32" min="8" max="128" />
                </div>
                <div class="input-group">
                    <span class="group-label">Inclure :</span>
                    <label><input type="checkbox" id="classic-lowercase" checked /> Minuscules</label>
                    <label><input type="checkbox" id="classic-uppercase" checked /> Majuscules</label>
                    <label><input type="checkbox" id="classic-numbers" checked /> Chiffres</label>
                    <label><input type="checkbox" id="classic-symbols" checked /> Symboles</label>
                </div>
                <div class="input-group">
                    <label>
                        <input type="checkbox" id="classic-weather" checked />
                        Utiliser l‚ÄôAPI m√©t√©o
                    </label>
                </div>
                <div class="output-group">
                    <label for="random-number">Token g√©n√©r√© :</label>
                    <textarea id="random-number" class="random-token-box" readonly rows="2"></textarea>
                </div>
                <button id="generate-button" class="generate-button">G√©n√©rer</button>
                <div id="feedback-classic" role="alert" aria-live="polite"></div>
                <div id="entropy-data" class="entropy-data"></div>
            </div>
        </div>

        <!-- Icosa√®dre Dynamique -->
        <div id="icosahedron-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Icosa√®dre Dynamique</h2>
                <button id="toggle-icosahedron-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="icosahedron-3d"></div>
        </div>

        <!-- Cubes Dynamiques -->
        <div id="cubes-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Cubes Dynamiques</h2>
                <button id="toggle-cubes-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="icosahedron-3d-cubes"></div>
        </div>

        <!-- Spirale Simple -->
        <div id="spiral-simple-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Spirale Dynamiques</h2>
                <button id="toggle-spiral-simple-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="spiral-simple-3d"></div>
        </div>

        <!-- Spirale Toro√Ødale -->
        <div id="spiral-torus-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Spirale Toro√Ødale</h2>
                <button id="toggle-spiral-torus-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="icosahedron-3d-spiral-torus"></div>
        </div>

        <!-- Tore-Ressorts -->
        <div id="torus-spring-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Syst√®me Tore-Ressorts-Sph√®res</h2>
                <button id="toggle-torus-spring-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="torus-spring-3d"></div>
        </div>

        <!-- Flux de Tokens -->
        <div id="stream-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Flux de Tokens Robustes</h2>
                <div class="input-group">
                    <label for="stream-length">Longueur du Token (8-128) :</label>
                    <input type="number" id="stream-length" value="32" min="8" max="128" />
                </div>
                <div class="input-group">
                    <span class="group-label">Inclure :</span>
                    <label><input type="checkbox" id="stream-lowercase" checked /> Minuscules</label>
                    <label><input type="checkbox" id="stream-uppercase" checked /> Majuscules</label>
                    <label><input type="checkbox" id="stream-numbers" checked /> Chiffres</label>
                    <label><input type="checkbox" id="stream-symbols" checked /> Symboles</label>
                </div>
                <div class="input-group">
                    <label for="stream-capacity">Capacit√© de Stockage (en Ko) :</label>
                    <input type="number" id="stream-capacity" value="1024" min="1" max="102400" />
                </div>
                <button id="start-stream-button" class="generate-button">D√©marrer Flux</button>
                <div class="stream-output-container">
                    <label for="generated-stream-output">Flux de Tokens :</label>
                    <textarea id="generated-stream-output" readonly rows="10" cols="80" 
                        style="width: 100%; background: #2a2a2a; color: #00ff00; font-family: monospace; border: 1px solid #444; padding: 10px; margin-top: 10px;"></textarea>
                    <div id="feedback-stream" style="margin-top: 10px; color: white; font-weight: bold;"></div>
                </div>
            </div>
            <div id="stream-visualizer-3d"></div>
        </div>

        <!-- CryptoTokenRiver -->
        <div id="crypto-token-river-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">CryptoTokenRiver</h2>
                <p>G√©n√©rateur continu de tokens cryptographiques robustes avec visualisation en rivi√®re temps r√©el</p>
                <button id="toggle-crypto-token-river-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="crypto-token-river-3d"></div>
        </div>

        <!-- Outil Interne de S√©curit√© Avanc√© -->
        <div id="internal-tool-interface" class="interface-section hidden">
            <div class="content-card internal-tool-container">
                <h2 class="title">G√©n√©rateur de S√©curit√© Interne</h2>
                <div class="input-group">
                    <label for="token-length">Longueur du Token/Mot de Passe (8-128) :</label>
                    <input type="number" id="token-length" value="32" min="8" max="128" />
                </div>
                <div class="input-group">
                    <span class="group-label">Inclure :</span>
                    <label><input type="checkbox" id="include-lowercase" checked /> Minuscules</label>
                    <label><input type="checkbox" id="include-uppercase" checked /> Majuscules</label>
                    <label><input type="checkbox" id="include-numbers" checked /> Chiffres</label>
                    <label><input type="checkbox" id="include-symbols" checked /> Symboles</label>
                </div>
                <button id="generate-secure-button" class="generate-button" disabled>G√©n√©rer Token S√©curis√©</button>
                <div class="output-group">
                    <label for="generated-token">Token G√©n√©r√© :</label>
                    <textarea id="generated-token" readonly rows="3"></textarea>
                    <button id="copy-token-button" class="generate-button copy-button" disabled>Copier</button>
                </div>
                <div id="feedback-message" role="alert" aria-live="polite"></div>
           </div>
        </div>

        <!-- Centrifugeuse Laser -->
        <div id="centrifuge-laser-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Centrifugeuse Laser</h2>
                <p>Syst√®me r√©volutionnaire de g√©n√©ration d'entropie par centrifugation laser avec inertie diff√©rentielle</p>
                <button id="toggle-centrifuge-laser-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="centrifuge-laser-3d"></div>
        </div>

        <!-- Centrifugeuse Laser 2.0 -->
        <div id="centrifuge-laser-v2-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">üöÄ Centrifugeuse Laser 2.0 - R√©volutionnaire</h2>
                <p>Syst√®me r√©volutionnaire avec collisions physiques, explosions atomiques et entropie rotationnelle maximale</p>
                <button id="toggle-centrifuge-laser-v2-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="centrifuge-laser-v2-3d"></div>
        </div>

        <!-- MetaCube Oracle Kal√©idoscopique -->
        <div id="metacube-oracle-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">üéµ MetaCube Oracle Playlist Kal√©idoscopique</h2>
                <p>Playlist automatique des 4 versions MetaCube Oracle avec contr√¥les avanc√©s</p>
                <div class="slideshow-controls">
                    <button id="start-slideshow" class="generate-button">üéµ D√©marrer Playlist</button>
                    <button id="stop-slideshow" class="generate-button">‚èπÔ∏è Arr√™ter Playlist</button>
                    <button id="next-version" class="generate-button">‚è≠Ô∏è Version Suivante</button>
                    <div class="version-indicator">
                        <span id="current-version-display">‚è∏Ô∏è MetaCube Oracle V1 (1/4)</span>
                    </div>
                </div>
                <div class="entropy-metrics">
                    <div>Entropie Shannon: <span id="shannon-entropy-display">0.0000</span></div>
                    <div>Accumulateur: <span id="entropy-accumulator-display">0.00</span></div>
                </div>
                <button id="toggle-metacube-oracle-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="metacube-oracle-3d"></div>
        </div>

        <!-- Interface Admin -->
        <div id="admin-interface" class="interface-section hidden">
            <div class="admin-container">
                <div class="admin-header">
                    <h2 class="admin-title">üéõÔ∏è Interface Admin Oracle d'Entropie</h2>
                    <div class="admin-status">
                        <span class="status-indicator active"></span>
                        <span>Syst√®me Op√©rationnel</span>
                    </div>
                </div>
                <div class="admin-dashboard">
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <h3>Entropie Shannon</h3>
                            <div class="metric-value" id="admin-shannon">5.0000</div>
                            <div class="metric-trend up">+0.12%</div>
                        </div>
                        <div class="metric-card">
                            <h3>Qualit√© Cryptographique</h3>
                            <div class="metric-value" id="admin-quality">98.7%</div>
                            <div class="metric-trend up">+0.05%</div>
                        </div>
                        <div class="metric-card">
                            <h3>Sources Actives</h3>
                            <div class="metric-value" id="admin-sources">12/12</div>
                            <div class="metric-trend stable">Stable</div>
                        </div>
                        <div class="metric-card">
                            <h3>D√©bit Entropie</h3>
                            <div class="metric-value" id="admin-throughput">47.3 Mbps</div>
                            <div class="metric-trend up">+2.1%</div>
                        </div>
                    </div>
                    <div class="performance-chart">
                        <h3>Performance Temps R√©el</h3>
                        <canvas id="admin-chart" width="800" height="300"></canvas>
                    </div>
                </div>
                <div class="admin-config">
                    <h3>Configuration Sources d'Entropie</h3>
                    <div class="config-grid">
                        <div class="config-section">
                            <h4>üå§Ô∏è Sources M√©t√©orologiques</h4>
                            <div class="config-controls">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="weather-enabled" checked>
                                    <span class="slider"></span>
                                    <span class="label">Donn√©es M√©t√©o Actives</span>
                                </label>
                                <div class="config-detail">
                                    <label>Stations: <span id="weather-stations">5</span></label>
                                    <input type="range" id="weather-stations-slider" min="1" max="10" value="5">
                                </div>
                                <div class="config-detail">
                                    <label>Fr√©quence: <span id="weather-freq">30s</span></label>
                                    <input type="range" id="weather-freq-slider" min="10" max="300" value="30">
                                </div>
                            </div>
                        </div>
                        <div class="config-section">
                            <h4>‚öõÔ∏è Simulation Quantique</h4>
                            <div class="config-controls">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="quantum-enabled" checked>
                                    <span class="slider"></span>
                                    <span class="label">N≈ìuds Quantiques Actifs</span>
                                </label>
                                <div class="config-detail">
                                    <label>N≈ìuds: <span id="quantum-nodes">8</span></label>
                                    <input type="range" id="quantum-nodes-slider" min="1" max="16" value="8">
                                </div>
                                <div class="config-detail">
                                    <label>D√©coh√©rence: <span id="quantum-decoherence">0.85</span></label>
                                    <input type="range" id="quantum-decoherence-slider" min="0.1" max="1" step="0.05" value="0.85">
                                </div>
                            </div>
                        </div>
                        <div class="config-section">
                            <h4>üî∑ G√©om√©tries Dynamiques</h4>
                            <div class="config-controls">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="geometry-enabled" checked>
                                    <span class="slider"></span>
                                    <span class="label">Visualiseurs 3D Actifs</span>
                                </label>
                                <div class="config-detail">
                                    <label>R√©solution: <span id="geometry-resolution">512x512</span></label>
                                    <select id="geometry-resolution-select">
                                        <option value="256">256x256</option>
                                        <option value="512" selected>512x512</option>
                                        <option value="1024">1024x1024</option>
                                    </select>
                                </div>
                                <div class="config-detail">
                                    <label>FPS Target: <span id="geometry-fps">30</span></label>
                                    <input type="range" id="geometry-fps-slider" min="15" max="60" value="30">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="admin-monitoring">
                    <h3>Monitoring Syst√®me</h3>
                    <div class="monitoring-grid">
                        <div class="monitor-card">
                            <h4>Performance GPU</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 67%"></div>
                            </div>
                            <span>67% Utilisation</span>
                        </div>
                        <div class="monitor-card">
                            <h4>M√©moire Syst√®me</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 43%"></div>
                            </div>
                            <span>43% Utilis√©e</span>
                        </div>
                        <div class="monitor-card">
                            <h4>R√©seau Backend</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 23%"></div>
                            </div>
                            <span>23% Charge</span>
                        </div>
                    </div>
                </div>
                <div class="admin-actions">
                    <button class="admin-button primary" id="save-config">üíæ Sauvegarder Configuration</button>
                    <button class="admin-button secondary" id="reset-config">üîÑ R√©initialiser</button>
                    <button class="admin-button warning" id="export-logs">üìä Exporter Logs</button>
                    <button class="admin-button danger" id="emergency-stop">üö® Arr√™t d'Urgence</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
import { initIcosahedronVisualizer } from './src/visualizers/icosahedron_visualizer.js';
import { initCubesVisualizer } from './src/visualizers/cubes_visualizer.js';
import { initSpiralSimpleVisualizer } from './src/visualizers/spiral_simple_visualizer.js';
import { initSpiralTorusVisualizer } from './src/visualizers/spiral_torus_visualizer.js';
import { initStreamVisualizer } from './src/visualizers/stream_visualizer.js';
import { initTorusSpringVisualizer } from './src/visualizers/torus_spring_visualizer.js';
import { initCentrifugeLaserVisualizer } from './src/visualizers/centrifuge_laser_visualizer.js';
import { initCryptoTokenRiverVisualizer } from './src/visualizers/crypto_token_river_visualizer.js';
import { initCentrifugeLaserV2Visualizer } from './src/visualizers/centrifuge_laser_v2_visualizer.js';
import { initMetaCubeOraclePlaylist } from './src/visualizers/metacube_oracle_playlist.js';
import { initClassicGenerator } from './src/views/classic_generator.js';
import { initInternalTool } from './src/views/internal_tool.js';
import './src/admin/admin-interface.js';

// D√©clarer les variables globales pour les instances de visualiseurs
let icosahedronVisualizer = null;
let cubesVisualizer = null;
let spiralSimpleVisualizer = null;
let spiralTorusVisualizer = null;
let streamVisualizer = null;
let torusSpringVisualizer = null;
let centrifugeLaserVisualizer = null;
let cryptoTokenRiverVisualizer = null;
let centrifugeLaserV2Visualizer = null;
let metaCubeOracleVisualizer = null;
let currentVisualizer = null;

const visualizerConfig = [
    { sectionId: 'icosahedron-interface', visualizerId: 'icosahedron-3d', toggleId: 'toggle-icosahedron-animation', initFn: initIcosahedronVisualizer, name: 'icosahedronVisualizer' },
    { sectionId: 'cubes-interface', visualizerId: 'icosahedron-3d-cubes', toggleId: 'toggle-cubes-animation', initFn: initCubesVisualizer, name: 'cubesVisualizer' },
    { sectionId: 'spiral-simple-interface', visualizerId: 'spiral-simple-3d', toggleId: 'toggle-spiral-simple-animation', initFn: initSpiralSimpleVisualizer, name: 'spiralSimpleVisualizer' },
    { sectionId: 'spiral-torus-interface', visualizerId: 'icosahedron-3d-spiral-torus', toggleId: 'toggle-spiral-torus-animation', initFn: initSpiralTorusVisualizer, name: 'spiralTorusVisualizer' },
    { sectionId: 'torus-spring-interface', visualizerId: 'torus-spring-3d', toggleId: 'toggle-torus-spring-animation', initFn: initTorusSpringVisualizer, name: 'torusSpringVisualizer' },
    { sectionId: 'stream-interface', visualizerId: 'stream-visualizer-3d', toggleId: 'start-stream-button', initFn: initStreamVisualizer, name: 'streamVisualizer' },
    { sectionId: 'centrifuge-laser-interface', visualizerId: 'centrifuge-laser-3d', toggleId: 'toggle-centrifuge-laser-animation', initFn: initCentrifugeLaserVisualizer, name: 'centrifugeLaserVisualizer' },
    { sectionId: 'centrifuge-laser-v2-interface', visualizerId: 'centrifuge-laser-v2-3d', toggleId: 'toggle-centrifuge-laser-v2-animation', initFn: initCentrifugeLaserV2Visualizer, name: 'centrifugeLaserV2Visualizer' },
    { sectionId: 'crypto-token-river-interface', visualizerId: 'crypto-token-river-3d', toggleId: 'toggle-crypto-token-river-animation', initFn: initCryptoTokenRiverVisualizer, name: 'cryptoTokenRiverVisualizer' },
    { sectionId: 'metacube-oracle-interface', visualizerId: 'metacube-oracle-3d', toggleId: 'toggle-metacube-oracle-animation', initFn: initMetaCubeOraclePlaylist, name: 'metaCubeOracleVisualizer' },
];

function cleanupVisualizer(visualizer) {
    if (visualizer && typeof visualizer.stop === 'function') {
        visualizer.stop();
    }
    window.streamTokenInterval && clearInterval(window.streamTokenInterval);
    window.streamAnimationId && cancelAnimationFrame(window.streamAnimationId);
    window.currentAnimation && cancelAnimationFrame(window.currentAnimation);
}

function updateToggleButtonText(button, visualizerInstance) {
    if (!button) return;
    if (!visualizerInstance || typeof visualizerInstance.isRunning !== 'function') {
        button.disabled = true;
        button.textContent = 'Erreur d‚Äôinitialisation';
        return;
    }
    button.disabled = false;
    button.textContent = visualizerInstance.isRunning() ? 'Stop Animation' : 'Start Animation';
}

function initAndStartVisualizer({ visualizerId, toggleId, initFn, name }) {
    const container = document.getElementById(visualizerId);
    const button = document.getElementById(toggleId);
    if (!container) {
        console.error(`Conteneur ${visualizerId} non trouv√©`);
        if (button) {
            button.disabled = true;
            button.textContent = 'Erreur d‚Äôinitialisation';
        }
        return null;
    }

    const tryInit = () => {
        if (container.offsetWidth > 0 && container.offsetHeight > 0) {
            try {
                console.log(`DEBUG: Initialisation de ${name}`);
                container.style.display = 'block';
                container.innerHTML = ''; // Reset container
                const visualizer = initFn(visualizerId);
                if (visualizer && typeof visualizer.start === 'function') {
                    visualizer.start();
                    updateToggleButtonText(button, visualizer);
                    return visualizer;
                } else {
                    throw new Error(`√âchec de l‚Äôinitialisation de ${name}`);
                }
            } catch (error) {
                console.error(`Erreur lors de l‚Äôinitialisation de ${name}:`, error);
                if (button) {
                    button.disabled = true;
                    button.textContent = 'Erreur d‚Äôinitialisation';
                }
                return null;
            }
        } else {
            console.warn(`Initialisation diff√©r√©e pour ${visualizerId}: dimensions non pr√™tes. R√©essai...`);
            return null;
        }
    };

    if (container.offsetWidth > 0 && container.offsetHeight > 0) {
        return tryInit();
    } else {
        const observer = new ResizeObserver((entries) => {
            for (const entry of entries) {
                if (entry.target === container && entry.contentRect.width > 0 && entry.contentRect.height > 0) {
                    const visualizer = tryInit();
                    if (visualizer) {
                        currentVisualizer = visualizer;
                        observer.disconnect();
                    }
                }
            }
        });
        observer.observe(container);
        // D√©lai de secours pour forcer une tentative apr√®s 1 seconde
        setTimeout(() => {
            if (!currentVisualizer) {
                console.log(`D√©lai de secours atteint pour ${visualizerId}. Nouvelle tentative forc√©e.`);
                const visualizer = tryInit();
                if (visualizer) {
                    currentVisualizer = visualizer;
                }
            }
        }, 1000);
        return null;
    }
}

function setupToggleButtonForVisualizer(visualizerId, toggleId, initFn, name) {
    const button = document.getElementById(toggleId);
    if (!button) return;

    button.addEventListener('click', async () => {
        if (!currentVisualizer || typeof currentVisualizer.isRunning !== 'function') {
            console.warn(`R√©initialisation de ${name} en raison d‚Äôun visualiseur invalide`);
            currentVisualizer = await initAndStartVisualizer({ visualizerId, toggleId, initFn, name });
            return;
        }

        if (currentVisualizer.isRunning()) {
            currentVisualizer.stop();
        } else {
            currentVisualizer.start();
        }
        updateToggleButtonText(button, currentVisualizer);
    });
}

function showSection(sectionId) {
    if (window.navigationLocked) return;
    window.navigationLocked = true;

    cleanupVisualizer(currentVisualizer);
    currentVisualizer = null;

    if (sectionId === 'admin-interface') {
        document.body.style.overflow = 'hidden';
        document.body.style.position = 'fixed';
    } else {
        document.body.style.overflow = 'auto';
        document.body.style.position = 'static';
    }

    document.querySelectorAll('.interface-section').forEach(section => {
        section.classList.add('hidden');
        section.style.display = 'none';
        section.style.visibility = 'hidden';
    });

    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.classList.remove('hidden');
        targetSection.style.display = 'flex';
        targetSection.style.visibility = 'visible';

        const config = visualizerConfig.find(cfg => cfg.sectionId === sectionId);
        if (config) {
            initAndStartVisualizer(config).then(visualizer => {
                currentVisualizer = visualizer;
                setupToggleButtonForVisualizer(config.visualizerId, config.toggleId, config.initFn, config.name);
            });
        }
    }

    document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
    let navButtonId = `nav-${sectionId.replace('-interface', '')}`;
    const navButton = document.getElementById(navButtonId);
    if (navButton) {
        navButton.classList.add('active');
    } else {
        console.warn(`Bouton de navigation ${navButtonId} non trouv√©`);
    }

    setTimeout(() => {
        window.dispatchEvent(new Event('resize'));
        window.navigationLocked = false;
    }, 100);
}

function setupNavButton(buttonId, sectionId) {
    const button = document.getElementById(buttonId);
    if (button) {
        button.addEventListener('click', () => showSection(sectionId));
    }
}

document.addEventListener('DOMContentLoaded', () => {
    visualizerConfig.forEach(({ sectionId }) => {
        let navButtonId = `nav-${sectionId.replace('-interface', '')}`;
        setupNavButton(navButtonId, sectionId);
    });
    // Ajouter manuellement les boutons non couverts par visualizerConfig
    setupNavButton('nav-main', 'main-interface');
    setupNavButton('nav-internal-tool', 'internal-tool-interface');
    setupNavButton('nav-admin-interface', 'admin-interface');

    // Initialiser les vues non-3D
    try {
        initClassicGenerator();
        initInternalTool();
    } catch (error) {
        console.error("Erreur lors de l'initialisation des vues non-3D :", error);
    }

    showSection('main-interface');

    window.addEventListener('resize', () => {
        if (currentVisualizer && typeof currentVisualizer.resize === 'function') {
            currentVisualizer.resize();
        }
    });
});
</script>
    <script type="module" src="/src/utils/three_utils.js"></script>
    <script type="module" src="/src/visualizers/icosahedron_visualizer.js"></script>
    <script type="module" src="/src/visualizers/cubes_visualizer.js"></script>
    <script type="module" src="/src/visualizers/spiral_simple_visualizer.js"></script>
    <script type="module" src="/src/visualizers/spiral_torus_visualizer.js"></script>
    <script type="module" src="/src/visualizers/stream_visualizer.js"></script>
    <script type="module" src="/src/visualizers/torus_spring_visualizer.js"></script>
    <script type="module" src="/src/visualizers/centrifuge_laser_visualizer.js"></script>
    <script type="module" src="/src/visualizers/crypto_token_river_visualizer.js"></script>
    <script type="module" src="/src/visualizers/centrifuge_laser_v2_visualizer.js"></script>
    <script type="module" src="/src/visualizers/metacube_oracle_playlist.js"></script>
    <script type="module" src="/src/views/classic_generator.js"></script>
    <script type="module" src="/src/views/internal_tool.js"></script>
    <script type="module" src="/src/main.js"></script>
</body>
</html>