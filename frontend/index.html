<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <!-- Favicons pour barre des t√¢ches -->
  <link rel="stylesheet" href="./src/styles/style.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon_1.png">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‚öõÔ∏è Oracle d'Entropie Quantique-G√©om√©trique</title>
</head>

<body>
    <div class="app-container">
        <nav class="navigation">
            <button id="nav-main" class="nav-button active">G√©n√©rateur Al√©atoire Classique</button>
            <button id="nav-icosahedron" class="nav-button">Icosa√®dre Dynamique</button>
            <button id="nav-cubes" class="nav-button">Cubes Dynamiques</button>
            <button id="nav-spiral-simple" class="nav-button">Spiral Dynamique</button>
            <button id="nav-spiral-torus" class="nav-button">Spiral Toro√Ødale</button>
            <button id="nav-centrifuge-laser" class="nav-button">Centrifugeuse Laser</button>
            <button id="nav-centrifuge-laser-v2" class="nav-button">Centrifugeuse Laser 2.0</button>
            <button id="nav-torus-spring" class="nav-button">Tore-Ressorts</button>
            <button id="nav-crypto-token-river" class="nav-button">CryptoTokenRiver</button>
            <button id="nav-stream" class="nav-button">Flux de Tokens</button>
            <button id="nav-internal-tool" class="nav-button">Outil Interne de S√©curit√©</button>
            <button id="nav-metacube-oracle" class="nav-button">MetaCube Oracle</button> <!-- AJOUT -->
            <button id="nav-admin-interface" class="nav-button">üéõÔ∏è Interface Admin</button>
        </nav>

        <!-- G√©n√©rateur Al√©atoire Classique -->
        <div id="main-interface" class="interface-section">
            <div class="content-card">
                <h1 class="title">Nombre Al√©atoire G√©n√©r√©</h1>
                <div class="input-group">
                    <label for="classic-token-length">Longueur du Token (8-128) :</label>
                    <input type="number" id="classic-token-length" value="32" min="8" max="128" />
                </div>
                <div class="input-group">
                    <span class="group-label">Inclure :</span>
                    <label><input type="checkbox" id="classic-lowercase" checked /> Minuscules</label>
                    <label><input type="checkbox" id="classic-uppercase" checked /> Majuscules</label>
                    <label><input type="checkbox" id="classic-numbers" checked /> Chiffres</label>
                    <label><input type="checkbox" id="classic-symbols" checked /> Symboles</label>
                </div>
                <div class="input-group">
                    <label>
                        <input type="checkbox" id="classic-weather" checked />
                        Utiliser l‚ÄôAPI m√©t√©o
                    </label>
                </div>
                <div class="output-group">
                    <label for="random-number">Token g√©n√©r√© :</label>
                    <textarea id="random-number" class="random-token-box" readonly rows="2"></textarea>
                </div>
                <button id="generate-button" class="generate-button">G√©n√©rer</button>
                <div id="feedback-classic" role="alert" aria-live="polite"></div>
                <div id="entropy-data" class="entropy-data"></div>
            </div>
        </div>

        <!-- Icosa√®dre Dynamique -->
        <div id="icosahedron-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Icosa√®dre Dynamique</h2>
                <button id="toggle-icosahedron-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="icosahedron-3d"></div>
        </div>

        <!-- Cubes Dynamiques -->
        <div id="cubes-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Cubes Dynamiques</h2>
                <button id="toggle-cubes-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="icosahedron-3d-cubes"></div>
        </div>

        <!-- Spirale Simple -->
        <div id="spiral-simple-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Spirale Dynamiques</h2>
                <button id="toggle-spiral-simple-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="spiral-simple-3d"></div>
        </div>

        <!-- Spirale Toro√Ødale -->
        <div id="spiral-torus-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Spirale Toro√Ødale</h2>
                <button id="toggle-spiral-torus-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="icosahedron-3d-spiral-torus"></div>
        </div>

         <!-- Tore-Ressorts -->
        <div id="torus-spring-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Syst√®me Tore-Ressorts-Sph√®res</h2>
                <button id="toggle-torus-spring-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="torus-spring-3d"></div>
        </div>

        <!-- Flux de Tokens -->
        <div id="stream-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Flux de Tokens Robustes</h2>
                <div class="input-group">
                    <label for="stream-length">Longueur du Token (8-128) :</label>
                    <input type="number" id="stream-length" value="32" min="8" max="128" />
                </div>
                <div class="input-group">
                    <span class="group-label">Inclure :</span>
                    <label><input type="checkbox" id="stream-lowercase" checked /> Minuscules</label>
                    <label><input type="checkbox" id="stream-uppercase" checked /> Majuscules</label>
                    <label><input type="checkbox" id="stream-numbers" checked /> Chiffres</label>
                    <label><input type="checkbox" id="stream-symbols" checked /> Symboles</label>
                </div>
                <div class="input-group">
                    <label for="stream-capacity">Capacit√© de Stockage (en Ko) :</label>
                    <input type="number" id="stream-capacity" value="1024" min="1" max="102400" />
                </div>
                <button id="start-stream-button" class="generate-button">D√©marrer Flux</button>
                
                <!-- AJOUT ICI : Bloc de sortie du flux -->
                <div class="stream-output-container">
                    <label for="generated-stream-output">Flux de Tokens :</label>
                    <textarea id="generated-stream-output" readonly rows="10" cols="80" 
                        style="width: 100%; background: #2a2a2a; color: #00ff00; font-family: monospace; border: 1px solid #444; padding: 10px; margin-top: 10px;"></textarea>
                    <div id="feedback-stream" style="margin-top: 10px; color: white; font-weight: bold;"></div>
                </div>
            </div>
            <div id="stream-visualizer-3d"></div>
        </div>

        <!-- CryptoTokenRiver -->
         <div id="crypto-token-river-interface" class="interface-section hidden">
    <div class="content-card">
        <h2 class="title">CryptoTokenRiver</h2>
        <p>G√©n√©rateur continu de tokens cryptographiques robustes avec visualisation en rivi√®re temps r√©el</p>
        <button id="toggle-crypto-token-river-animation" class="generate-button">Stop Animation</button>
    </div>
    <div id="crypto-token-river-3d"></div>
</div>

        <!-- Outil Interne de S√©curit√© Avanc√© -->
        <div id="internal-tool-interface" class="interface-section hidden">
            <div class="content-card internal-tool-container">
                <h2 class="title">G√©n√©rateur de S√©curit√© Interne</h2>
                <div class="input-group">
                    <label for="token-length">Longueur du Token/Mot de Passe (8-128) :</label>
                    <input type="number" id="token-length" value="32" min="8" max="128" />
                </div>
                <div class="input-group">
                    <span class="group-label">Inclure :</span>
                    <label><input type="checkbox" id="include-lowercase" checked /> Minuscules</label>
                    <label><input type="checkbox" id="include-uppercase" checked /> Majuscules</label>
                    <label><input type="checkbox" id="include-numbers" checked /> Chiffres</label>
                    <label><input type="checkbox" id="include-symbols" checked /> Symboles</label>
                </div>
                <button id="generate-secure-button" class="generate-button" disabled>G√©n√©rer Token S√©curis√©</button>
                <div class="output-group">
                    <label for="generated-token">Token G√©n√©r√© :</label>
                    <textarea id="generated-token" readonly rows="3"></textarea>
                    <button id="copy-token-button" class="generate-button copy-button" disabled>Copier</button>
                </div>
                <div id="feedback-message" role="alert" aria-live="polite"></div>
            </div>
        </div>

        <!-- Centrifugeuse Laser -->
        <div id="centrifuge-laser-interface" class="interface-section hidden">
            <div class="content-card">
                <h2 class="title">Centrifugeuse Laser</h2>
                <p>Syst√®me r√©volutionnaire de g√©n√©ration d'entropie par centrifugation laser avec inertie diff√©rentielle</p>
                <button id="toggle-centrifuge-laser-animation" class="generate-button">Stop Animation</button>
            </div>
            <div id="centrifuge-laser-3d"></div>
        </div>

        <!-- Centrifugeuse Laser 2.0 -->
        <div id="centrifuge-laser-v2-interface" class="interface-section hidden">
    <div class="content-card">
        <h2 class="title">üöÄ Centrifugeuse Laser 2.0 - R√©volutionnaire</h2>
        <p>Syst√®me r√©volutionnaire avec collisions physiques, explosions atomiques et entropie rotationnelle maximale</p>
        <button id="toggle-centrifuge-laser-v2-animation" class="generate-button">Stop Animation</button>
    </div>
    <div id="centrifuge-laser-v2-3d"></div>
</div>

        <!-- MetaCube Oracle Kal√©idoscopique -->
        <div id="metacube-oracle-interface" class="interface-section hidden">
    <div class="content-card">
        <h2 class="title">üéµ MetaCube Oracle Playlist Kal√©idoscopique</h2>
        <p>Playlist automatique des 4 versions MetaCube Oracle avec contr√¥les avanc√©s</p>
        
        <!-- Contr√¥les de playlist -->
        <div class="slideshow-controls">
            <button id="start-slideshow" class="generate-button">üéµ D√©marrer Playlist</button>
            <button id="stop-slideshow" class="generate-button">‚èπÔ∏è Arr√™ter Playlist</button>
            <button id="next-version" class="generate-button">‚è≠Ô∏è Version Suivante</button>
            <div class="version-indicator">
                <span id="current-version-display">‚è∏Ô∏è MetaCube Oracle V1 (1/4)</span>
            </div>
        </div>
        
        <div class="entropy-metrics">
            <div>Entropie Shannon: <span id="shannon-entropy-display">0.0000</span></div>
            <div>Accumulateur: <span id="entropy-accumulator-display">0.00</span></div>
        </div>
        <button id="toggle-metacube-oracle-animation" class="generate-button">Stop Animation</button>
    </div>
    <div id="metacube-oracle-3d"></div>
</div>
        
        
     <!-- Interface Admin -->
        <div id="admin-interface" class="interface-section hidden">
            <div class="admin-container">
        <!-- Header Admin -->
        <div class="admin-header">
            <h2 class="admin-title">üéõÔ∏è Interface Admin Oracle d'Entropie</h2>
            <div class="admin-status">
                <span class="status-indicator active"></span>
                <span>Syst√®me Op√©rationnel</span>
            </div>
        </div>

        <!-- Dashboard Principal -->
        <div class="admin-dashboard">
            <!-- M√©triques Temps R√©el -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>Entropie Shannon</h3>
                    <div class="metric-value" id="admin-shannon">5.0000</div>
                    <div class="metric-trend up">+0.12%</div>
                </div>
                <div class="metric-card">
                    <h3>Qualit√© Cryptographique</h3>
                    <div class="metric-value" id="admin-quality">98.7%</div>
                    <div class="metric-trend up">+0.05%</div>
                </div>
                <div class="metric-card">
                    <h3>Sources Actives</h3>
                    <div class="metric-value" id="admin-sources">12/12</div>
                    <div class="metric-trend stable">Stable</div>
                </div>
                <div class="metric-card">
                    <h3>D√©bit Entropie</h3>
                    <div class="metric-value" id="admin-throughput">47.3 Mbps</div>
                    <div class="metric-trend up">+2.1%</div>
                </div>
            </div>

            <!-- Graphique Performance -->
            <div class="performance-chart">
                <h3>Performance Temps R√©el</h3>
                <canvas id="admin-chart" width="800" height="300"></canvas>
            </div>
        </div>

        <!-- Configuration Sources -->
        <div class="admin-config">
            <h3>Configuration Sources d'Entropie</h3>
            <div class="config-grid">
                <!-- Sources M√©t√©o -->
                <div class="config-section">
                    <h4>üå§Ô∏è Sources M√©t√©orologiques</h4>
                    <div class="config-controls">
                        <label class="toggle-switch">
                            <input type="checkbox" id="weather-enabled" checked>
                            <span class="slider"></span>
                            <span class="label">Donn√©es M√©t√©o Actives</span>
                        </label>
                        <div class="config-detail">
                            <label>Stations: <span id="weather-stations">5</span></label>
                            <input type="range" id="weather-stations-slider" min="1" max="10" value="5">
                        </div>
                        <div class="config-detail">
                            <label>Fr√©quence: <span id="weather-freq">30s</span></label>
                            <input type="range" id="weather-freq-slider" min="10" max="300" value="30">
                        </div>
                    </div>
                </div>

                <!-- Sources Quantiques -->
                <div class="config-section">
                    <h4>‚öõÔ∏è Simulation Quantique</h4>
                    <div class="config-controls">
                        <label class="toggle-switch">
                            <input type="checkbox" id="quantum-enabled" checked>
                            <span class="slider"></span>
                            <span class="label">N≈ìuds Quantiques Actifs</span>
                        </label>
                        <div class="config-detail">
                            <label>N≈ìuds: <span id="quantum-nodes">8</span></label>
                            <input type="range" id="quantum-nodes-slider" min="1" max="16" value="8">
                        </div>
                        <div class="config-detail">
                            <label>D√©coh√©rence: <span id="quantum-decoherence">0.85</span></label>
                            <input type="range" id="quantum-decoherence-slider" min="0.1" max="1" step="0.05" value="0.85">
                        </div>
                    </div>
                </div>

                <!-- Sources G√©om√©triques -->
                <div class="config-section">
                    <h4>üî∑ G√©om√©tries Dynamiques</h4>
                    <div class="config-controls">
                        <label class="toggle-switch">
                            <input type="checkbox" id="geometry-enabled" checked>
                            <span class="slider"></span>
                            <span class="label">Visualiseurs 3D Actifs</span>
                        </label>
                        <div class="config-detail">
                            <label>R√©solution: <span id="geometry-resolution">512x512</span></label>
                            <select id="geometry-resolution-select">
                                <option value="256">256x256</option>
                                <option value="512" selected>512x512</option>
                                <option value="1024">1024x1024</option>
                            </select>
                        </div>
                        <div class="config-detail">
                            <label>FPS Target: <span id="geometry-fps">30</span></label>
                            <input type="range" id="geometry-fps-slider" min="15" max="60" value="30">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Monitoring Syst√®me -->
        <div class="admin-monitoring">
            <h3>Monitoring Syst√®me</h3>
            <div class="monitoring-grid">
                <div class="monitor-card">
                    <h4>Performance GPU</h4>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 67%"></div>
                    </div>
                    <span>67% Utilisation</span>
                </div>
                <div class="monitor-card">
                    <h4>M√©moire Syst√®me</h4>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 43%"></div>
                    </div>
                    <span>43% Utilis√©e</span>
                </div>
                <div class="monitor-card">
                    <h4>R√©seau Backend</h4>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 23%"></div>
                    </div>
                    <span>23% Charge</span>
                </div>
            </div>
        </div>

        <!-- Actions Admin -->
        <div class="admin-actions">
            <button class="admin-button primary" id="save-config">üíæ Sauvegarder Configuration</button>
            <button class="admin-button secondary" id="reset-config">üîÑ R√©initialiser</button>
            <button class="admin-button warning" id="export-logs">üìä Exporter Logs</button>
            <button class="admin-button danger" id="emergency-stop">üö® Arr√™t d'Urgence</button>
        </div>
    </div>
</div>


    <script type="module" src="/src/utils/three_utils.js"></script>
    <script type="module" src="/src/visualizers/icosahedron_visualizer.js"></script>
    <script type="module" src="/src/visualizers/cubes_visualizer.js"></script>
    <script type="module" src="/src/visualizers/spiral_simple_visualizer.js"></script>
    <script type="module" src="/src/visualizers/spiral_torus_visualizer.js"></script>
    <script type="module" src="/src/visualizers/stream_visualizer.js"></script>
    <script type="module" src="/src/views/classic_generator.js"></script>
    <script type="module" src="/src/views/internal_tool.js"></script>
    <script type="module" src="/src/main.js"></script>
    <script type="module" src="/src/visualizers/centrifuge_laser_v2_visualizer.js"></script>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    // Liste des IDs de visualizers 3D
    const visualizerIds = [
        "icosahedron-3d",
        "icosahedron-3d-cubes",
        "spiral-simple-3d",
        "icosahedron-3d-spiral-torus",
        "torus-spring-3d",
        "stream-visualizer-3d",
        "centrifuge-laser-3d",
        "centrifuge-laser-v2-3d",
        "crypto-token-river-3d",
        "metacube-oracle-3d"
    ];

    // Fonction d'initialisation diff√©r√©e pour chaque visualizer
    function initializeVisualizerWhenReady(elementId, initFn) {
        const el = document.getElementById(elementId);
        if (!el) return;
        function tryInit() {
            if (el.offsetWidth > 0 && el.offsetHeight > 0) {
                if (typeof initFn === "function") initFn(el);
                return true;
            }
            return false;
        }
        if (!tryInit()) {
            const observer = new ResizeObserver(() => {
                if (tryInit()) observer.disconnect();
            });
            observer.observe(el);
        }
    }

    // Map d'initialisation pour chaque visualizer (√† adapter selon ton projet)
    const visualizerInitMap = {
        "icosahedron-3d": window.initIcosahedron3D,
        "icosahedron-3d-cubes": window.initCubes3D,
        "spiral-simple-3d": window.initSpiralSimple3D,
        "icosahedron-3d-spiral-torus": window.initSpiralTorus3D,
        "torus-spring-3d": window.initTorusSpring3D,
        "stream-visualizer-3d": window.initStreamVisualizer3D,
        "centrifuge-laser-3d": window.initCentrifugeLaser3D,
        "centrifuge-laser-v2-3d": window.initCentrifugeLaserV2_3D,
        "crypto-token-river-3d": window.initCryptoTokenRiver3D,
        "metacube-oracle-3d": window.initMetacubeOracle3D
    };

    // Navigation universelle
    document.querySelectorAll('.nav-button').forEach(button => {
        button.addEventListener('click', function(event) {
            event.preventDefault();
            event.stopPropagation();

            // Nettoyage des animations globales
            if (window.streamTokenInterval) {
                clearInterval(window.streamTokenInterval);
                window.streamTokenInterval = null;
            }
            if (window.streamAnimationId) {
                cancelAnimationFrame(window.streamAnimationId);
                window.streamAnimationId = null;
            }
            if (window.currentAnimation) {
                cancelAnimationFrame(window.currentAnimation);
                window.currentAnimation = null;
            }

            // Reset admin
            if (document.getElementById('admin-interface').style.display === 'flex') {
                document.body.style.overflow = 'auto';
                document.body.style.position = 'static';
            }

            // Masquer toutes les sections
            document.querySelectorAll('.interface-section').forEach(section => {
                section.style.display = 'none';
                section.style.visibility = 'hidden';
                section.classList.remove('active');
            });

            // D√©terminer la section cible
            let targetId = this.id.replace('nav-', '');
            if (targetId !== 'admin-interface') {
                targetId = targetId + '-interface';
            }

            // Afficher la section cible
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.style.display = 'flex';
                targetSection.style.visibility = 'visible';
                targetSection.classList.add('active');

                // Initialiser le visualizer 3D si la section en contient un
                visualizerIds.forEach(vid => {
                    if (targetSection.querySelector(`#${vid}`)) {
                        initializeVisualizerWhenReady(vid, visualizerInitMap[vid]);
                    }
                });

                // Forcer un resize global (utile pour Three.js)
                setTimeout(() => {
                    window.dispatchEvent(new Event('resize'));
                }, 150);
            }

            // Mettre √† jour les boutons actifs
            document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
        });
    });

    // Afficher la premi√®re section au chargement
    document.getElementById('main-interface').style.display = 'flex';
    document.getElementById('nav-main').classList.add('active');
});
</script>
<script>
// NAVIGATION UNIVERSELLE UNIQUE - Solution d√©finitive
document.addEventListener('DOMContentLoaded', function() {
    // Initialiser la premi√®re section
    document.getElementById('main-interface').style.display = 'flex';
    document.getElementById('nav-main').classList.add('active');
    
    // Navigation universelle pour TOUS les boutons
    document.querySelectorAll('.nav-button').forEach(button => {
        button.addEventListener('click', function(event) {
            event.preventDefault();
            event.stopPropagation();
            
            // D√©clarer targetId correctement
            let targetId = this.id.replace('nav-', '');
            
            // Nettoyage complet avant changement
            if (window.streamTokenInterval) {
                clearInterval(window.streamTokenInterval);
                window.streamTokenInterval = null;
            }
            if (window.streamAnimationId) {
                cancelAnimationFrame(window.streamAnimationId);
                window.streamAnimationId = null;
            }
            if (window.currentAnimation) {
                cancelAnimationFrame(window.currentAnimation);
                window.currentAnimation = null;
            }
            
            // Reset admin
            if (document.getElementById('admin-interface').style.display === 'flex') {
                document.body.style.overflow = 'auto';
                document.body.style.position = 'static';
            }
            
            // Masquer TOUTES les sections
            document.querySelectorAll('.interface-section').forEach(section => {
                section.style.display = 'none';
                section.style.visibility = 'hidden';
                section.classList.remove('active');
            });
            
            // Correspondance ID correcte
            if (targetId !== 'admin-interface') {
                targetId = targetId + '-interface';
            }
            
            // Afficher la section cible
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.style.display = 'flex';
                targetSection.style.visibility = 'visible';
                targetSection.classList.add('active');
                
                // Force refresh pour visualiseurs 3D
                setTimeout(() => {
                    window.dispatchEvent(new Event('resize'));
                }, 150);
            }
            
            // Mettre √† jour boutons actifs
            document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
            
            console.log('DEBUG: Changement vers section:', targetId);
        });
    });
});
</script>
<script>
//  Navigation avec gestion performance
let navigationLocked = false;

document.querySelectorAll('.nav-button').forEach(button => {
    button.addEventListener('click', () => {
        // √âviter les clics multiples rapides
        if (navigationLocked) return;
        navigationLocked = true;
        
        // Arr√™ter toutes les animations avant changement
        if (window.currentAnimation) {
            cancelAnimationFrame(window.currentAnimation);
        }
        
        // Navigation normale
        document.querySelectorAll('.interface-section').forEach(section => {
            section.classList.remove('active');
        });
        
        let targetId = button.id.replace('nav-', '');
        if (targetId !== 'admin-interface') {
            targetId = targetId + '-interface';
        }
        
        const targetSection = document.getElementById(targetId);
        if (targetSection) {
            targetSection.classList.add('active');
        }
        
        document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        
        // D√©bloquer apr√®s un d√©lai
        setTimeout(() => {
            navigationLocked = false;
        }, 100);
    });
});
</script>
<script>
//  - Gestion des dimensions Three.js
function initializeVisualizerWhenReady(sectionId) {
    const section = document.getElementById(sectionId);
    if (!section) return;
    
    // Attendre que la section soit visible
    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            if (mutation.type === 'attributes' && 
                mutation.attributeName === 'class' &&
                section.classList.contains('active')) {
                
                // Section maintenant visible - forcer resize des visualiseurs
                setTimeout(() => {
                    const canvas3d = section.querySelector('[id$="-3d"]');
                    if (canvas3d) {
                        // D√©clencher resize selon [4]
                        window.dispatchEvent(new Event('resize'));
                    }
                }, 100);
                
                observer.disconnect();
            }
        });
    });
    
    observer.observe(section, { attributes: true });
}

// Navigation universelle avec gestion 3D
document.querySelectorAll('.nav-button').forEach(button => {
    button.addEventListener('click', () => {
        // Masquer toutes les sections
        document.querySelectorAll('.interface-section').forEach(section => {
            section.classList.remove('active');
        });
        
        // Afficher la section cible
        let targetId = button.id.replace('nav-', '');
        if (targetId !== 'admin-interface') {
            targetId = targetId + '-interface';
        }
        
        const targetSection = document.getElementById(targetId);
        if (targetSection) {
            targetSection.classList.add('active');
            
            // Initialiser le visualiseur 3D si n√©cessaire
            initializeVisualizerWhenReady(targetId);
        }
        
        // Boutons actifs
        document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
    });
});
</script>
<script>
// Solution selon  - DOMContentLoaded + Event delegation
document.addEventListener('DOMContentLoaded', function() {
    // Navigation universelle selon 
    document.querySelectorAll('.nav-button').forEach(button => {
        button.addEventListener('click', function(event) {
            event.stopPropagation(); // √âviter bubbling 
            
            // Masquer toutes les sections
            document.querySelectorAll('.interface-section').forEach(section => {
                section.style.display = 'none'; // Force hide 
            });
            
            // Afficher la section cible
            let targetId = this.id.replace('nav-', '');
            if (targetId !== 'admin-interface') {
                targetId = targetId + '-interface';
            }
            
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.style.display = 'flex'; // Force show 
                targetSection.style.visibility = 'visible'; // Ensure visible 
            }
            
            // Boutons actifs
            document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
        });
    });
});
</script>
<script>
// CORRIG√â : Navigation universelle avec gestion correcte de targetId et reset admin
document.querySelectorAll('.nav-button').forEach(button => {
    button.addEventListener('click', function(event) {
        event.stopPropagation();

        let targetId = this.id.replace('nav-', ''); // D√âCLARER targetId ici

        // Reset admin
        if (document.getElementById('admin-interface').style.display === 'flex') {
            document.body.style.overflow = 'auto';
        }

        // Masquer toutes les sections
        document.querySelectorAll('.interface-section').forEach(section => {
            section.style.display = 'none';
        });

        // Afficher la section cible
        if (targetId !== 'admin-interface') {
            targetId = targetId + '-interface';
        }

        const targetSection = document.getElementById(targetId);
        if (targetSection) {
            targetSection.style.display = 'flex';
        }

        // Boutons actifs
        document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
        this.classList.add('active');
    });
});
</script>
</body>
</html>